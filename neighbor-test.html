<!DOCTYPE html>
<html>
<head>
    <title>TypeJumper Neighbor Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f0f8ff;
        }
        .test-container { 
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .game-preview { 
            width: 400px; 
            height: 300px; 
            background: #16213e; 
            position: relative; 
            overflow: hidden;
        }
        .platform { 
            position: absolute; 
            width: 45px; 
            height: 45px; 
            background: #4ECDC4; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-weight: bold; 
            font-size: 20px; 
            border: 2px solid #000; 
            cursor: pointer; 
            transition: all 0.2s;
        }
        .platform.jumpable { 
            background: #2E8B8B; 
            border: 3px solid #FFD700; 
            color: white; 
            transform: scale(1.05);
        }
        .platform.occupied { 
            background: #FF69B4; 
            color: white;
        }
        .unicorn { 
            position: absolute; 
            width: 27px; 
            height: 27px; 
            background: #FF69B4; 
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%); 
            z-index: 10; 
            transition: all 0.3s ease;
        }
        .unicorn::after { 
            content: ''; 
            position: absolute; 
            top: -8px; 
            left: 50%; 
            transform: translateX(-50%); 
            width: 0; 
            height: 0; 
            border-left: 5px solid transparent; 
            border-right: 5px solid transparent; 
            border-bottom: 8px solid #FFD700;
        }
        .instructions { 
            background: #fff5e6; 
            padding: 15px; 
            border-radius: 8px; 
            margin-bottom: 15px; 
            border-left: 4px solid #FF8C00;
        }
        .controls { 
            display: flex; 
            gap: 10px; 
            margin-bottom: 15px; 
            flex-wrap: wrap;
        }
        button { 
            padding: 8px 15px; 
            background: #4CAF50; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            font-size: 14px;
        }
        button:hover { 
            background: #45a049;
        }
        .debug-info { 
            background: #e8f5e9; 
            padding: 10px; 
            border-radius: 4px; 
            font-family: monospace; 
            font-size: 13px; 
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>TypeJumper Neighbor Jumping Test</h1>
    
    <div class="instructions">
        <h3>üéÆ How to Test:</h3>
        <ol>
            <li><strong>Click on a platform</strong> to move the unicorn there</li>
            <li><strong>Neighbor platforms</strong> will be highlighted in dark blue with gold borders</li>
            <li><strong>Only neighbors</strong> can be jumped to (6 directions: ‚úñÔ∏è pattern)</li>
            <li><strong>Non-neighbors</strong> remain normal color and cannot be selected</li>
        </ol>
        <p><strong>Expected behavior:</strong> Only the 6 surrounding platforms should be jumpable!</p>
    </div>
    
    <div class="test-container">
        <div class="game-preview" id="gamePreview">
            <!-- Platforms will be generated here -->
            <div class="unicorn" id="unicorn"></div>
        </div>
        
        <div class="debug-info">
            <h3>üìä Debug Info:</h3>
            <div id="debugOutput">
                <p><strong>Current Position:</strong> <span id="currentPos">None</span></p>
                <p><strong>Neighbors:</strong> <span id="neighbors">[]</span></p>
                <p><strong>Jumpable Letters:</strong> <span id="jumpableLetters">[]</span></p>
                <p><strong>Platform Size:</strong> 90px (50% bigger)</p>
                <p><strong>Spacing:</strong> 24px (20% farther)</p>
            </div>
        </div>
    </div>
    
    <div class="controls">
        <button id="btnReset">üîÑ Reset Test</button>
        <button id="btnShowGrid">üìê Toggle Grid</button>
        <button id="btnTestAll">üß™ Test All Positions</button>
    </div>
    
    <div id="testResults" style="margin-top: 20px;"></div>
    
    <script>
        // Test data simulating the game's platform arrangement
        const platformSize = 45; // Scaled down for preview
        const platformSpacing = 12; // Scaled down for preview
        const platforms = [];
        let currentPlatform = null;
        let showGrid = false;
        
        const gamePreview = document.getElementById('gamePreview');
        const unicorn = document.getElementById('unicorn');
        const debugOutput = document.getElementById('debugOutput');
        
        // Create a 5x5 grid of platforms (simplified checkerboard)
        function createTestPlatforms() {
            gamePreview.innerHTML = '';
            platforms.length = 0;
            gamePreview.appendChild(unicorn);
            
            const cols = 5;
            const rows = 5;
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
            let letterIndex = 0;
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    // Create platforms in checkerboard pattern
                    if ((row + col) % 2 === 0) {
                        const x = col * (platformSize + platformSpacing);
                        const y = row * (platformSize + platformSpacing);
                        const letter = letters[letterIndex % letters.length];
                        letterIndex++;
                        
                        const platform = document.createElement('div');
                        platform.className = 'platform';
                        platform.textContent = letter;
                        platform.style.left = x + 'px';
                        platform.style.top = y + 'px';
                        platform.dataset.letter = letter;
                        platform.dataset.row = row;
                        platform.dataset.col = col;
                        
                        platform.addEventListener('click', () => {
                            moveUnicornToPlatform(platform);
                        });
                        
                        gamePreview.appendChild(platform);
                        platforms.push(platform);
                    }
                }
            }
            
            // Position unicorn on center platform initially
            const centerPlatform = platforms.find(p => 
                parseInt(p.dataset.row) === 2 && parseInt(p.dataset.col) === 2
            );
            if (centerPlatform) {
                moveUnicornToPlatform(centerPlatform);
            }
        }
        
        function moveUnicornToPlatform(platform) {
            // Remove occupied class from current platform
            if (currentPlatform) {
                currentPlatform.classList.remove('occupied');
            }
            
            // Set new current platform
            currentPlatform = platform;
            currentPlatform.classList.add('occupied');
            
            // Position unicorn on top of the platform
            const rect = platform.getBoundingClientRect();
            const gameRect = gamePreview.getBoundingClientRect();
            unicorn.style.left = (rect.left - gameRect.left + 9) + 'px';
            unicorn.style.top = (rect.top - gameRect.top - 27) + 'px';
            
            // Update neighbor highlighting
            updateNeighborHighlighting();
            
            // Update debug info
            updateDebugInfo();
        }
        
        function updateNeighborHighlighting() {
            // Reset all platforms
            platforms.forEach(p => {
                p.classList.remove('jumpable');
            });
            
            if (!currentPlatform) return;
            
            const currentRow = parseInt(currentPlatform.dataset.row);
            const currentCol = parseInt(currentPlatform.dataset.col);
            
            // Define neighbor offsets (6 directions) - correct checkerboard pattern
            const neighborOffsets = [
                {dr: -1, dc: -1}, // upper left
                {dr: -1, dc: 1},  // upper right
                {dr: 0, dc: -2},  // left
                {dr: 0, dc: 2},   // right
                {dr: 1, dc: -1},  // lower left
                {dr: 1, dc: 1}    // lower right
            ];
            
            // Find and highlight neighbors
            neighborOffsets.forEach(offset => {
                const neighborRow = currentRow + offset.dr;
                const neighborCol = currentCol + offset.dc;
                
                const neighbor = platforms.find(p => 
                    parseInt(p.dataset.row) === neighborRow && 
                    parseInt(p.dataset.col) === neighborCol
                );
                
                if (neighbor && neighbor !== currentPlatform) {
                    neighbor.classList.add('jumpable');
                }
            });
        }
        
        function updateDebugInfo() {
            if (!currentPlatform) {
                document.getElementById('currentPos').textContent = 'None';
                document.getElementById('neighbors').textContent = '[]';
                document.getElementById('jumpableLetters').textContent = '[]';
                return;
            }
            
            const currentRow = currentPlatform.dataset.row;
            const currentCol = currentPlatform.dataset.col;
            document.getElementById('currentPos').textContent = `(${currentRow}, ${currentCol}) - ${currentPlatform.dataset.letter}`;
            
            // Find neighbors
            const neighborOffsets = [
                {dr: -1, dc: -1}, {dr: -1, dc: 1}, {dr: 0, dc: -2}, 
                {dr: 0, dc: 2}, {dr: 1, dc: -1}, {dr: 1, dc: 1}
            ];
            
            const neighbors = [];
            const jumpableLetters = [];
            
            neighborOffsets.forEach(offset => {
                const neighborRow = parseInt(currentRow) + offset.dr;
                const neighborCol = parseInt(currentCol) + offset.dc;
                
                const neighbor = platforms.find(p => 
                    parseInt(p.dataset.row) === neighborRow && 
                    parseInt(p.dataset.col) === neighborCol
                );
                
                if (neighbor) {
                    neighbors.push(`(${neighborRow},${neighborCol})`);
                    jumpableLetters.push(neighbor.dataset.letter);
                }
            });
            
            document.getElementById('neighbors').textContent = neighbors.join(', ') || 'None';
            document.getElementById('jumpableLetters').textContent = jumpableLetters.join(', ') || 'None';
        }
        
        function toggleGrid() {
            showGrid = !showGrid;
            platforms.forEach(p => {
                p.style.border = showGrid ? '2px dashed rgba(255,255,255,0.5)' : '2px solid #000';
            });
        }
        
        function testAllPositions() {
            const testResults = document.getElementById('testResults');
            testResults.innerHTML = '<h3>üß™ Neighbor Test Results:</h3>';
            
            let allTestsPassed = true;
            
            platforms.forEach((platform, index) => {
                moveUnicornToPlatform(platform);
                
                const currentRow = parseInt(platform.dataset.row);
                const currentCol = parseInt(platform.dataset.col);
                
                // Count jumpable neighbors
                const jumpableNeighbors = platforms.filter(p => 
                    p.classList.contains('jumpable')
                );
                
                const expectedNeighbors = 6; // Should have up to 6 neighbors
                const actualNeighbors = jumpableNeighbors.length;
                
                const status = actualNeighbors <= expectedNeighbors ? '‚úÖ PASS' : '‚ùå FAIL';
                const color = actualNeighbors <= expectedNeighbors ? '#d4edda' : '#f8d7da';
                
                if (actualNeighbors > expectedNeighbors) {
                    allTestsPassed = false;
                }
                
                const resultDiv = document.createElement('div');
                resultDiv.style.padding = '8px';
                resultDiv.style.margin = '5px 0';
                resultDiv.style.backgroundColor = color;
                resultDiv.style.borderRadius = '4px';
                resultDiv.innerHTML = `<strong>Position (${currentRow},${currentCol}) ${platform.dataset.letter}:</strong> ${actualNeighbors} jumpable neighbors - ${status}`;
                testResults.appendChild(resultDiv);
            });
            
            const summaryDiv = document.createElement('div');
            summaryDiv.style.padding = '12px';
            summaryDiv.style.margin = '10px 0';
            summaryDiv.style.backgroundColor = allTestsPassed ? '#d4edda' : '#f8d7da';
            summaryDiv.style.borderRadius = '4px';
            summaryDiv.style.fontWeight = 'bold';
            summaryDiv.textContent = allTestsPassed ? 'üéâ All tests passed! Neighbor system working correctly.' : '‚ö†Ô∏è Some tests failed. Check neighbor counting logic.';
            testResults.appendChild(summaryDiv);
        }
        
        // Event listeners
        document.getElementById('btnReset').addEventListener('click', createTestPlatforms);
        document.getElementById('btnShowGrid').addEventListener('click', toggleGrid);
        document.getElementById('btnTestAll').addEventListener('click', testAllPositions);
        
        // Initialize
        createTestPlatforms();
    </script>
</body>
</html>